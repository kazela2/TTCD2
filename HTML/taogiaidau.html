<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>T·∫°o Gi·∫£i ƒê·∫•u</title>
    <link rel="stylesheet" href="/CSS/taogiaidau.css" />
</head>
<body>
    <div class="header">
        <div class="logo">üéÆ</div>
        <div class="nav">
            <a href="index.html">Trang ch·ªß</a>
            <a href="giaidau.html">Gi·∫£i ƒë·∫•u</a>
            <div class="dropdown">
                <a href="#">ƒê·ªôi thi ƒë·∫•u ‚ñæ</a>
                <div class="dropdown-content">
                    <a href="timdoituyen.html">T√¨m ƒë·ªôi tuy·ªÉn</a>
                    <a href="taodoituyen.html">T·∫°o ƒë·ªôi tuy·ªÉn</a>
                </div>
            </div>
            <a href="trandau.html">Tr·∫≠n ƒê·∫•u</a>
            <a href="xephang.html">B·∫£ng X·∫øp H·∫°ng</a>
            <a href="lichsugiaidau.html">L·ªãch S·ª≠ ƒê·∫•u</a>
            <a href="admin.html">Qu·∫£n L√Ω</a>
        </div>
    </div>

    <div class="main-content">
        <div class="container">
            <div class="form-header">
                <div class="form-icon">üèÜ</div>
                <h2>T·∫°o Gi·∫£i ƒê·∫•u M·ªõi</h2>
                <p class="form-subtitle">Kh·ªüi t·∫°o m·ªôt gi·∫£i ƒë·∫•u esports chuy√™n nghi·ªáp</p>
            </div>
            
            <form id="form-giaidau" autocomplete="off">
                <div class="form-row">
                    <div class="form-group">
                        <label for="TenGiaiDau">
                            <span class="label-icon">üìù</span>
                            T√™n Gi·∫£i ƒê·∫•u
                        </label>
                        <input type="text" id="TenGiaiDau" name="TenGiaiDau" 
                               placeholder="Nh·∫≠p t√™n gi·∫£i ƒë·∫•u..." required />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="NgayBatDau">
                            <span class="label-icon">üìÖ</span>
                            Ng√†y B·∫Øt ƒê·∫ßu
                        </label>
                        <input type="date" id="NgayBatDau" name="NgayBatDau" required />
                    </div>
                    
                    <div class="form-group">
                        <label for="NgayKetThuc">
                            <span class="label-icon">üèÅ</span>
                            Ng√†y K·∫øt Th√∫c
                        </label>
                        <input type="date" id="NgayKetThuc" name="NgayKetThuc" required />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="MoTa">
                            <span class="label-icon">üìÑ</span>
                            M√¥ T·∫£ Gi·∫£i ƒê·∫•u
                        </label>
                        <textarea id="MoTa" name="MoTa" rows="5" 
                                  placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ gi·∫£i ƒë·∫•u, quy ƒë·ªãnh, gi·∫£i th∆∞·ªüng..." required></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-cancel">H·ªßy</button>
                    <button type="submit" class="btn-submit">
                        <span class="btn-icon">‚ú®</span>
                        T·∫°o Gi·∫£i ƒê·∫•u
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.getElementById('form-giaidau').addEventListener('submit', function(e) {
            e.preventDefault();

            const data = {
                TenGiai: document.getElementById('TenGiaiDau').value.trim(),
                NgayBatDau: document.getElementById('NgayBatDau').value,
                NgayKetThuc: document.getElementById('NgayKetThuc').value,
                MoTa: document.getElementById('MoTa').value.trim()
            };

            // Validation
            if (new Date(data.NgayBatDau) >= new Date(data.NgayKetThuc)) {
                alert('Ng√†y k·∫øt th√∫c ph·∫£i sau ng√†y b·∫Øt ƒë·∫ßu!');
                return;
            }

            const submitBtn = document.querySelector('.btn-submit');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="btn-icon">‚è≥</span>ƒêang t·∫°o...';
            submitBtn.disabled = true;

            fetch('http://127.0.0.1:5000/GiaiDau/Add', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(response => {
                if (response.message) {
                    alert('T·∫°o gi·∫£i ƒë·∫•u th√†nh c√¥ng!');
                    this.reset();
                } else if (response.error) {
                    alert('L·ªói: ' + response.error);
                }
            })
            .catch(error => {
                alert('L·ªói khi g·ª≠i d·ªØ li·ªáu: ' + error.message);
            })
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });

        document.querySelector('.btn-cancel').addEventListener('click', function() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën h·ªßy? D·ªØ li·ªáu s·∫Ω b·ªã m·∫•t.')) {
                document.getElementById('form-giaidau').reset();
            }
        });
    </script>
</body>
</html>