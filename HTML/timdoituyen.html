<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√¨m ƒê·ªôi Tuy·ªÉn</title>
    <link rel="stylesheet" href="/CSS/timdoituyen.css">
</head>
<body>
        <div class="header">
        <div class="logo">üéÆ</div>
        <div class="nav">
          <a href="index.html">Trang ch·ªß</a>
          <a href="giaidau.html">Gi·∫£i ƒë·∫•u</a>
          <div class="dropdown">
            <a href="#">ƒê·ªôi thi ƒë·∫•u ‚ñæ</a>
            <div class="dropdown-content">
              <a href="timdoituyen.html">T√¨m ƒë·ªôi tuy·ªÉn</a>
              <a href="taodoituyen.html">T·∫°o ƒë·ªôi tuy·ªÉn</a>
            </div>
          </div>
          <a href="trandau.html">Tr·∫≠n ƒê·∫•u</a>
          <a href="xephang.html">B·∫£ng X·∫øp H·∫°ng</a>
          <a href="lichsugiaidau.html">L·ªãch S·ª≠ ƒê·∫•u</a>
          <a href="admin.html">Qu·∫£n L√Ω</a>
        </div>
    </div>
<div class="search-bar">
  <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm theo t√™n ƒë·ªôi ho·∫∑c t√™n gi·∫£i ƒë·∫•u..." oninput="searchTeams()" />
</div>



    <div class="team-container" id="teamContainer">
  <!-- C√°c card ƒë·ªôi v√† th√†nh vi√™n s·∫Ω ƒë∆∞·ª£c ch√®n t·∫°i ƒë√¢y b·∫±ng JS -->
</div>

<script>
  let fullTeamList = [];

  async function loadTeams() {
    const container = document.getElementById('teamContainer');
    container.innerHTML = '';

    try {
      const resDoi = await fetch('http://127.0.0.1:5000/DoiThiDau/GetAll');
      const doiList = await resDoi.json();
      fullTeamList = [];

      for (const doi of doiList) {
        const resTV = await fetch(`http://127.0.0.1:5000/ThanhVienDoi/GetByDoi/${doi.IdDoi}`);
        const tvList = await resTV.json();

        fullTeamList.push({
          ...doi,
          ThanhVien: tvList
        });
      }

      renderTeams(fullTeamList);
    } catch (error) {
      console.error('L·ªói khi load d·ªØ li·ªáu ƒë·ªôi:', error);
    }
  }

  function renderTeams(teamList) {
    const container = document.getElementById('teamContainer');
    container.innerHTML = '';

    if (teamList.length === 0) {
      container.innerHTML = '<p>Kh√¥ng t√¨m th·∫•y ƒë·ªôi n√†o ph√π h·ª£p.</p>';
      return;
    }

    teamList.forEach(doi => {
      const card = document.createElement('div');
      card.classList.add('team-card');
      card.innerHTML = `
        <h3>${doi.TenDoi}</h3>
        <p><strong>Gi·∫£i ƒë·∫•u:</strong> ${doi.TenGiai || 'Ch∆∞a r√µ'}</p>
        <p><strong>HLV:</strong> ${doi.TenHuanLuyenVien}</p>
        <h4>Th√†nh vi√™n:</h4>
        <ul>
          ${doi.ThanhVien.map(tv => `
            <li><strong>${tv.HoTen}</strong> (${tv.ViTri || 'N/A'}) - S·ªë √°o: ${tv.SoAo || '-'}</li>
          `).join('')}
        </ul>
      `;
      container.appendChild(card);
    });
  }

  function searchTeams() {
    const keyword = document.getElementById('searchInput').value.toLowerCase();
    const filtered = fullTeamList.filter(doi =>
      doi.TenDoi.toLowerCase().includes(keyword) ||
      (doi.TenGiai && doi.TenGiai.toLowerCase().includes(keyword))
    );
    renderTeams(filtered);
  }

  window.onload = loadTeams;
</script>


</body>
</html>