<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quáº£n lÃ½ giáº£i Ä‘áº¥u</title>
  <link rel="stylesheet" href="/CSS/quanlygiaidau.css" />
</head>
<body>
  <div class="sidebar">
    <h2>Quáº£n Trá»‹</h2>
    <a href="quanlygiaidau.html">ğŸ“¦ Quáº£n lÃ½ Giáº£i Äáº¥u</a>
    <a href="quanlydoituyenvathanhvien.html">ğŸ§¾ Quáº£n lÃ½ Äá»™i Tuyá»ƒn vÃ  ThÃ nh ViÃªn</a>
    <a href="quanli_trandau.html">ğŸ‘¥ Quáº£n lÃ½ Tráº­n Äáº¥u</a>
    <a href="quanli_xephang.html">ğŸ“Š Quáº£n LÃ½ Báº£ng Xáº¿p Háº¡ng</a>
    <a href="quanli_lichsu.html">ğŸ“Š Lá»‹ch Sá»­ Giáº£i Äáº¥u</a>
    <a href="index.html">Quay Láº¡i</a>
  </div>

  <div class="content">
    <h2>Danh sÃ¡ch Giáº£i Äáº¥u</h2>
    <table id="giaiTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>TÃªn Giáº£i</th>
          <th>NgÃ y Báº¯t Äáº§u</th>
          <th>NgÃ y Káº¿t ThÃºc</th>
          <th>MÃ´ Táº£</th>
          <th>HÃ nh Ä‘á»™ng</th>
        </tr>
      </thead>
      <tbody>
        <!-- Dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c chÃ¨n á»Ÿ Ä‘Ã¢y báº±ng JavaScript -->
      </tbody>
    </table>
  </div>

  <script>
    async function loadGiaiDau() {
      try {
        const res = await fetch("http://127.0.0.1:5000/GiaiDau/GetAll");
        const data = await res.json();
        const tbody = document.querySelector("#giaiTable tbody");
        tbody.innerHTML = "";

        data.forEach(giai => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${giai.IdGiai}</td>
            <td>${giai.TenGiai}</td>
            <td>${giai.NgayBatDau || ""}</td>
            <td>${giai.NgayKetThuc || ""}</td>
            <td>${giai.MoTa || ""}</td>
            <td><button onclick="xoaGiaiDau(${giai.IdGiai})" >XoÃ¡</button></td>
          `;
          tbody.appendChild(row);
        });
      } catch (error) {
        console.error("Lá»—i khi táº£i giáº£i Ä‘áº¥u:", error);
      }
    }

    async function xoaGiaiDau(id) {
      if (confirm("Báº¡n cÃ³ cháº¯c muá»‘n xoÃ¡ giáº£i Ä‘áº¥u nÃ y khÃ´ng?")) {
        try {
          const res = await fetch(`http://127.0.0.1:5000/GiaiDau/Delete/${id}`, {
            method: "DELETE"
          });
          const result = await res.json();
          if (res.ok) {
            alert(result.message || "XoÃ¡ thÃ nh cÃ´ng!");
            loadGiaiDau(); // Táº£i láº¡i danh sÃ¡ch sau khi xoÃ¡
          } else {
            alert(result.error || "CÃ³ lá»—i xáº£y ra khi xoÃ¡!");
          }
        } catch (error) {
          console.error("Lá»—i khi gá»i API xoÃ¡:", error);
        }
      }
    }

    window.onload = loadGiaiDau;
  </script>
</body>
</html>
