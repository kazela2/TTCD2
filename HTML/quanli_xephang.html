<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Qu·∫£n l√Ω B·∫£ng X·∫øp H·∫°ng</title>
    <link rel="stylesheet" href="/CSS/quanli_xephang.css" />
</head>
<body>
    <div class="sidebar">
        <h2>Qu·∫£n Tr·ªã</h2>
        <a href="quanlygiaidau.html">üì¶ Qu·∫£n l√Ω Gi·∫£i ƒê·∫•u</a>
        <a href="quanly_Team_Player.html">üßæ Qu·∫£n l√Ω Team v√† Player</a>
        <a href="quanli_trandau.html">üéÆ Qu·∫£n l√Ω Tr·∫≠n ƒê·∫•u</a>
        <a href="quanli_xephang.html" class="active">üìä Qu·∫£n L√Ω B·∫£ng X·∫øp H·∫°ng</a>
        <a href="quanli_taikhoan.html">ü™™ Qu·∫£n L√Ω T√†i kho·∫£n</a>
        <a href="quanli_map.html">üó∫Ô∏è Qu·∫£n L√Ω Chi Ti·∫øt Map</a>
        <a href="index.html">üè† Quay L·∫°i</a>
    </div>

    <div class="content">
        <div class="header">
            <h2>üìä Qu·∫£n L√Ω B·∫£ng X·∫øp H·∫°ng</h2>
            <div class="search-container">
                <input type="text" id="searchInput" class="search-input" placeholder="üîç T√¨m ki·∫øm ƒë·ªôi ho·∫∑c gi·∫£i ƒë·∫•u...">
            </div>
        </div>

        <div class="table-container">
            <div class="btn-container">
                <select id="tournamentFilter" class="btn" style="background: #95a5a6; color: white;">
                    <option value="">üîΩ L·ªçc theo gi·∫£i ƒë·∫•u</option>
                    <!-- Options s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
                </select>
                <button class="btn btn-primary" onclick="openRankingModal()">‚ûï Th√™m B·∫£ng X·∫øp H·∫°ng</button>
                <button class="btn btn-success" onclick="initializeTournament()">üéÆ Kh·ªüi T·∫°o B·∫£ng X·∫øp H·∫°ng</button>
                <button class="btn btn-warning" onclick="updateFromMatches()">üîÑ C·∫≠p Nh·∫≠t T·ª´ Tr·∫≠n ƒê·∫•u</button>
                <button class="btn btn-info" onclick="exportRankingData()">üì§ Xu·∫•t D·ªØ Li·ªáu</button>
            </div>

            <div id="rankingsLoadingState" class="loading">
                üîÑ ƒêang t·∫£i d·ªØ li·ªáu b·∫£ng x·∫øp h·∫°ng...
            </div>

            <div id="noData" class="no-data" style="display: none;">
                <p>üì≠ Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ hi·ªÉn th·ªã</p>
            </div>

            <table id="rankingsTable" style="display: none;">
                <thead>
                    <tr>
                        <th>H·∫°ng</th>
                        <th>T√™n ƒê·ªôi</th>
                        <th>Gi·∫£i ƒê·∫•u</th>
                        <th>Tr·∫≠n ƒê√£ ƒê·∫•u</th>
                        <th>Tr·∫≠n Th·∫Øng</th>
                        <th>Tr·∫≠n Thua</th>
                        <th>ƒêi·ªÉm</th>
                        <th>H√†nh ƒê·ªông</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ch√®n ·ªü ƒë√¢y b·∫±ng JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification" style="display: none;">
        <span id="notificationMessage"></span>
        <span class="notification-close" onclick="closeNotification()">√ó</span>
    </div>

    <!-- Modal for Ranking Management -->
    <div id="rankingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="rankingModalTitle">Ch·ªânh S·ª≠a B·∫£ng X·∫øp H·∫°ng</h3>
                <span class="close" onclick="closeRankingModal()">√ó</span>
            </div>
            <div id="rankingModalAlert"></div>
            <div class="modal-body">
                <form id="rankingForm">
                    <div class="form-group">
                        <label for="tournamentSelect">Gi·∫£i ƒê·∫•u *</label>
                        <select id="tournamentSelect" name="tournamentSelect" required>
                            <option value="">Ch·ªçn gi·∫£i ƒë·∫•u</option>
                            <!-- Options s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="teamSelect">ƒê·ªôi *</label>
                        <select id="teamSelect" name="teamSelect" required>
                            <option value="">Ch·ªçn ƒë·ªôi</option>
                            <!-- Options s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="matchesPlayed">Tr·∫≠n ƒê√£ ƒê·∫•u</label>
                        <input type="number" id="matchesPlayed" name="matchesPlayed" min="0" value="0" required>
                    </div>

                    <div class="form-group">
                        <label for="matchesWon">Tr·∫≠n Th·∫Øng</label>
                        <input type="number" id="matchesWon" name="matchesWon" min="0" value="0" required>
                    </div>

                    <div class="form-group">
                        <label for="matchesLost">Tr·∫≠n Thua</label>
                        <input type="number" id="matchesLost" name="matchesLost" min="0" value="0" required>
                    </div>

                    <div class="form-group">
                        <label for="mapsWon">Map Th·∫Øng</label>
                        <input type="number" id="mapsWon" name="mapsWon" min="0" value="0" required>
                    </div>

                    <div class="form-group">
                        <label for="mapsLost">Map Thua</label>
                        <input type="number" id="mapsLost" name="mapsLost" min="0" value="0" required>
                    </div>

                    <div class="form-group">
                        <label for="points">ƒêi·ªÉm</label>
                        <input type="number" id="points" name="points" min="0" value="0" required>
                    </div>

                    <div class="form-group">
                        <label for="currentRank">H·∫°ng Hi·ªán T·∫°i</label>
                        <input type="number" id="currentRank" name="currentRank" min="1" value="1" required>
                    </div>

                    <div class="btn-container">
                        <button type="submit" class="btn btn-primary">üíæ L∆∞u</button>
                        <button type="button" class="btn btn-danger" onclick="closeRankingModal()">‚ùå H·ªßy</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>X√°c Nh·∫≠n</h3>
                <span class="close" onclick="closeConfirmModal()">√ó</span>
            </div>
            <div id="confirmModalAlert"></div>
            <div class="modal-body">
                <p id="confirmMessage">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán h√†nh ƒë·ªông n√†y?</p>
                <div class="btn-container">
                    <button class="btn btn-danger" id="confirmYes">‚úì C√≥</button>
                    <button class="btn btn-primary" onclick="closeConfirmModal()">‚úó Kh√¥ng</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:5000';
        let currentEditingRankingId = null;
        let rankingsData = [];
        let tournamentsData = [];
        let teamsData = [];

        // Notification functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const messageElement = document.getElementById('notificationMessage');
            messageElement.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            setTimeout(closeNotification, 3000);
        }

        function closeNotification() {
            document.getElementById('notification').style.display = 'none';
        }

        // Show/hide loading
        function showLoading() {
            document.getElementById('rankingsLoadingState').style.display = 'block';
            document.getElementById('rankingsTable').style.display = 'none';
            document.getElementById('noData').style.display = 'none';
        }

        function hideLoading() {
            document.getElementById('rankingsLoadingState').style.display = 'none';
        }

        // Modal functions for rankings
        function openRankingModal(rankingId = null) {
            const modal = document.getElementById('rankingModal');
            const title = document.getElementById('rankingModalTitle');
            document.getElementById('rankingModalAlert').innerHTML = '';

            if (rankingId) {
                title.textContent = 'Ch·ªânh S·ª≠a B·∫£ng X·∫øp H·∫°ng';
                currentEditingRankingId = rankingId;
                loadRankingData(rankingId);
            } else {
                title.textContent = 'Th√™m B·∫£ng X·∫øp H·∫°ng M·ªõi';
                currentEditingRankingId = null;
                document.getElementById('rankingForm').reset();
                document.getElementById('tournamentSelect').value = '';
                document.getElementById('teamSelect').value = '';
                updateTeamSelect();
            }

            modal.style.display = 'block';
        }

        function closeRankingModal() {
            document.getElementById('rankingModal').style.display = 'none';
            currentEditingRankingId = null;
            document.getElementById('rankingForm').reset();
            document.getElementById('tournamentSelect').value = '';
            document.getElementById('teamSelect').value = '';
            updateTeamSelect();
        }

        // Confirmation modal functions
        function showConfirmModal(message, callback) {
            document.getElementById('confirmMessage').textContent = message;
            document.getElementById('confirmYes').onclick = callback;
            document.getElementById('confirmModal').style.display = 'block';
            document.getElementById('confirmModalAlert').innerHTML = '';
        }

        function closeConfirmModal() {
            document.getElementById('confirmModal').style.display = 'none';
        }

        // Load rankings data
        async function loadRankings(tournamentId = '') {
            try {
                showLoading();
                const url = tournamentId ? `${API_BASE_URL}/BangXepHang/GetByGiai/${tournamentId}` : `${API_BASE_URL}/BangXepHang/GetAll`;
                const response = await fetch(url);
                const data = await response.json();
                hideLoading();
                if (response.ok) {
                    rankingsData = data;
                    renderRankingsTable();
                } else {
                    showNotification(`L·ªói t·∫£i b·∫£ng x·∫øp h·∫°ng: ${data.error}`, 'error');
                    rankingsData = [];
                    renderRankingsTable();
                }
            } catch (error) {
                hideLoading();
                showNotification(`L·ªói k·∫øt n·ªëi khi t·∫£i b·∫£ng x·∫øp h·∫°ng: ${error.message}`, 'error');
                rankingsData = [];
                renderRankingsTable();
            }
        }

        // Render rankings table
        function renderRankingsTable() {
            const tbody = document.querySelector('#rankingsTable tbody');
            const table = document.getElementById('rankingsTable');
            const noData = document.getElementById('noData');

            if (rankingsData.length === 0) {
                table.style.display = 'none';
                noData.style.display = 'block';
                return;
            }

            table.style.display = 'table';
            noData.style.display = 'none';
            tbody.innerHTML = '';

            rankingsData.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.HangHienTai}</td>
                    <td>${row.TenTeam}</td>
                    <td>${row.TenGiai}</td>
                    <td>${row.TranDa}</td>
                    <td>${row.TranThang}</td>
                    <td>${row.TranThua}</td>
                    <td>${row.TiLe}</td>
                    <td>${row.Diem}</td>
                    <td>
                        <button class="btn btn-primary" onclick="openRankingModal(${row.IdXH})">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="deleteRanking(${row.IdXH})">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Load ranking data for editing
        async function loadRankingData(rankingId) {
            try {
                showLoading();
                const response = await fetch(`${API_BASE_URL}/BangXepHang/GetById/${rankingId}`);
                const data = await response.json();
                hideLoading();
                if (response.ok) {
                    document.getElementById('tournamentSelect').value = data.IdGiai || '';
                    await updateTeamSelect(data.IdGiai);
                    document.getElementById('teamSelect').value = data.IdTeam || '';
                    document.getElementById('matchesPlayed').value = data.TranDa || 0;
                    document.getElementById('matchesWon').value = data.TranThang || 0;
                    document.getElementById('matchesLost').value = data.TranThua || 0;
                    document.getElementById('mapsWon').value = data.MapThang || 0;
                    document.getElementById('mapsLost').value = data.MapThua || 0;
                    document.getElementById('points').value = data.Diem || 0;
                    document.getElementById('currentRank').value = data.HangHienTai || 0;
                } else {
                    showNotification(`L·ªói t·∫£i d·ªØ li·ªáu b·∫£ng x·∫øp h·∫°ng: ${data.error}`, 'error');
                }
            } catch (error) {
                hideLoading();
                showNotification(`L·ªói k·∫øt n·ªëi khi t·∫£i d·ªØ li·ªáu b·∫£ng x·∫øp h·∫°ng: ${error.message}`, 'error');
            }
        }

        // Load tournaments for filter and modal
        async function loadTournaments() {
            try {
                console.log("Fetching tournaments from /GiaiDau/GetAll");
                const response = await fetch(`${API_BASE_URL}/GiaiDau/GetAll`);
                const data = await response.json();
                console.log("Tournament data:", data);
                if (response.ok) {
                    tournamentsData = data;
                    const tournamentSelect = document.getElementById('tournamentSelect');
                    const tournamentFilter = document.getElementById('tournamentFilter');
                    tournamentSelect.innerHTML = '<option value="">Ch·ªçn gi·∫£i ƒë·∫•u</option>';
                    tournamentFilter.innerHTML = '<option value="">üîΩ L·ªçc theo gi·∫£i ƒë·∫•u</option>';

                    if (data.length === 0) {
                        showNotification('Kh√¥ng c√≥ gi·∫£i ƒë·∫•u n√†o trong h·ªá th·ªëng!', 'warning');
                    }

                    data.forEach(tournament => {
                        console.log("Adding tournament:", tournament.TenGiai);
                        const option1 = document.createElement('option');
                        option1.value = tournament.IdGiai;
                        option1.textContent = tournament.TenGiai;
                        tournamentSelect.appendChild(option1);

                        const option2 = document.createElement('option');
                        option2.value = tournament.IdGiai;
                        option2.textContent = tournament.TenGiai;
                        tournamentFilter.appendChild(option2);
                    });
                } else {
                    showNotification(`L·ªói t·∫£i danh s√°ch gi·∫£i ƒë·∫•u: ${data.error}`, 'error');
                }
            } catch (error) {
                console.error("Error in loadTournaments:", error);
                showNotification(`L·ªói k·∫øt n·ªëi khi t·∫£i gi·∫£i ƒë·∫•u: ${error.message}`, 'error');
            }
        }

        // Load teams for modal
        async function loadTeams() {
            try {
                console.log("Fetching teams from /Team/GetAll");
                const response = await fetch(`${API_BASE_URL}/Team/GetAll`);
                const data = await response.json();
                console.log("Team data:", data);
                if (response.ok) {
                    teamsData = data;
                    // Kh√¥ng g·ªçi updateTeamSelect ·ªü ƒë√¢y ƒë·ªÉ ƒë·∫£m b·∫£o teamSelect r·ªóng khi ch∆∞a ch·ªçn gi·∫£i ƒë·∫•u
                } else {
                    showNotification(`L·ªói t·∫£i danh s√°ch ƒë·ªôi: ${data.error}`, 'error');
                }
            } catch (error) {
                console.error("Error in loadTeams:", error);
                showNotification(`L·ªói k·∫øt n·ªëi khi t·∫£i ƒë·ªôi: ${error.message}`, 'error');
            }
        }

        // Update team select based on tournament
        async function updateTeamSelect(tournamentId = '') {
            const teamSelect = document.getElementById('teamSelect');
            teamSelect.innerHTML = '<option value="">Ch·ªçn ƒë·ªôi</option>';

            if (!tournamentId) {
                // N·∫øu ch∆∞a ch·ªçn gi·∫£i ƒë·∫•u, kh√¥ng hi·ªÉn th·ªã ƒë·ªôi n√†o
                return;
            }

            let filteredTeams = teamsData.filter(team => team.IdGiai === parseInt(tournamentId));
            if (filteredTeams.length === 0) {
                showNotification('Kh√¥ng c√≥ ƒë·ªôi n√†o thu·ªôc gi·∫£i ƒë·∫•u n√†y!', 'warning');
            }

            filteredTeams.forEach(team => {
                const option = document.createElement('option');
                option.value = team.IdTeam;
                option.textContent = team.TenTeam;
                teamSelect.appendChild(option);
            });
        }

        // Initialize tournament ranking
        async function initializeTournament() {
            const tournamentId = document.getElementById('tournamentFilter').value;
            if (!tournamentId) {
                showNotification('Vui l√≤ng ch·ªçn gi·∫£i ƒë·∫•u ƒë·ªÉ kh·ªüi t·∫°o!', 'error');
                return;
            }

            showConfirmModal('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën kh·ªüi t·∫°o b·∫£ng x·∫øp h·∫°ng cho gi·∫£i ƒë·∫•u n√†y?', async function() {
                try {
                    showLoading();
                    const response = await fetch(`${API_BASE_URL}/BangXepHang/InitializeForTournament/${tournamentId}`, {
                        method: 'POST'
                    });
                    const result = await response.json();
                    hideLoading();
                    if (response.ok) {
                        showNotification(result.message, 'success');
                        loadRankings(tournamentId);
                        closeConfirmModal();
                    } else {
                        showNotification(`L·ªói: ${result.error}`, 'error');
                    }
                } catch (error) {
                    hideLoading();
                    showNotification(`L·ªói k·∫øt n·ªëi: ${error.message}`, 'error');
                }
            });
        }

        // Update rankings from matches
        async function updateFromMatches() {
            const tournamentId = document.getElementById('tournamentFilter').value;
            if (!tournamentId) {
                showNotification('Vui l√≤ng ch·ªçn gi·∫£i ƒë·∫•u ƒë·ªÉ c·∫≠p nh·∫≠t!', 'error');
                return;
            }

            showConfirmModal('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën c·∫≠p nh·∫≠t b·∫£ng x·∫øp h·∫°ng t·ª´ k·∫øt qu·∫£ tr·∫≠n ƒë·∫•u?', async function() {
                try {
                    showLoading();
                    const response = await fetch(`${API_BASE_URL}/BangXepHang/UpdateFromMatches/${tournamentId}`, {
                        method: 'PUT'
                    });
                    const result = await response.json();
                    hideLoading();
                    if (response.ok) {
                        showNotification(result.message, 'success');
                        loadRankings(tournamentId);
                        closeConfirmModal();
                    } else {
                        showNotification(`L·ªói: ${result.error}`, 'error');
                    }
                } catch (error) {
                    hideLoading();
                    showNotification(`L·ªói k·∫øt n·ªëi: ${error.message}`, 'error');
                }
            });
        }

        // Delete function
        async function deleteRanking(rankingId) {
            showConfirmModal('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a m·ª•c b·∫£ng x·∫øp h·∫°ng n√†y kh√¥ng?', async function() {
                try {
                    showLoading();
                    const response = await fetch(`${API_BASE_URL}/BangXepHang/Delete/${rankingId}`, {
                        method: 'DELETE'
                    });
                    const result = await response.json();
                    hideLoading();
                    if (response.ok) {
                        showNotification(result.message, 'success');
                        loadRankings(document.getElementById('tournamentFilter').value);
                        closeConfirmModal();
                    } else {
                        showNotification(`L·ªói: ${result.error}`, 'error');
                    }
                } catch (error) {
                    hideLoading();
                    showNotification(`L·ªói k·∫øt n·ªëi: ${error.message}`, 'error');
                }
            });
        }

        // Export function
        function exportRankingData() {
            if (rankingsData.length === 0) {
                showNotification('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t!', 'error');
                return;
            }

            const csvContent = [
                'H·∫°ng,T√™n ƒê·ªôi,Gi·∫£i ƒê·∫•u,Tr·∫≠n ƒê√£ ƒê·∫•u,Tr·∫≠n Th·∫Øng,Tr·∫≠n Thua,T·ª∑ L·ªá Map,ƒêi·ªÉm',
                ...rankingsData.map(row => 
                    `${row.HangHienTai},${row.TenTeam},${row.TenGiai},${row.TranDa},${row.TranThang},${row.TranThua},${row.TiLe},${row.Diem}`
                )
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', 'bang_xep_hang.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showNotification('Xu·∫•t d·ªØ li·ªáu th√†nh c√¥ng!', 'success');
        }

        // Form submission handler
        document.getElementById('rankingForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const formData = {
                IdGiai: parseInt(document.getElementById('tournamentSelect').value),
                IdTeam: parseInt(document.getElementById('teamSelect').value),
                TranDa: parseInt(document.getElementById('matchesPlayed').value) || 0,
                TranThang: parseInt(document.getElementById('matchesWon').value) || 0,
                TranThua: parseInt(document.getElementById('matchesLost').value) || 0,
                MapThang: parseInt(document.getElementById('mapsWon').value) || 0,
                MapThua: parseInt(document.getElementById('mapsLost').value) || 0,
                Diem: parseInt(document.getElementById('points').value) || 0,
                HangHienTai: parseInt(document.getElementById('currentRank').value) || 1
            };

            if (!formData.IdGiai || !formData.IdTeam) {
                document.getElementById('rankingModalAlert').innerHTML = 
                    '<div class="alert alert-error">‚ö†Ô∏è Vui l√≤ng ch·ªçn gi·∫£i ƒë·∫•u v√† ƒë·ªôi!</div>';
                return;
            }

            try {
                showLoading();
                const url = currentEditingRankingId ? `${API_BASE_URL}/BangXepHang/Update/${currentEditingRankingId}` : `${API_BASE_URL}/BangXepHang/Create`;
                const method = currentEditingRankingId ? 'PUT' : 'POST';
                const response = await fetch(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                const result = await response.json();
                hideLoading();
                if (response.ok) {
                    document.getElementById('rankingModalAlert').innerHTML = 
                        `<div class="alert alert-success">‚úÖ ${result.message}</div>`;
                    setTimeout(() => {
                        closeRankingModal();
                        loadRankings(document.getElementById('tournamentFilter').value);
                    }, 1500);
                } else {
                    document.getElementById('rankingModalAlert').innerHTML = 
                        `<div class="alert alert-error">‚ùå ${result.error}</div>`;
                }
            } catch (error) {
                hideLoading();
                document.getElementById('rankingModalAlert').innerHTML = 
                    `<div class="alert alert-error">‚ùå L·ªói k·∫øt n·ªëi: ${error.message}</div>`;
            }
        });

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadRankings();
            loadTournaments();
            loadTeams();

            // Initialize search functionality
            document.getElementById('searchInput').addEventListener('input', function() {
                const searchValue = this.value.toLowerCase();
                const filteredData = rankingsData.filter(row =>
                    row.TenTeam.toLowerCase().includes(searchValue) ||
                    row.TenGiai.toLowerCase().includes(searchValue)
                );
                rankingsData = filteredData;
                renderRankingsTable();
            });

            // Initialize tournament filter
            document.getElementById('tournamentFilter').addEventListener('change', function() {
                loadRankings(this.value);
            });

            // Update team select when tournament changes
            document.getElementById('tournamentSelect').addEventListener('change', function() {
                updateTeamSelect(this.value);
            });
        });

        // Close modals when clicking outside
        window.onclick = function(event) {
            const rankingModal = document.getElementById('rankingModal');
            const confirmModal = document.getElementById('confirmModal');

            if (event.target === rankingModal) {
                closeRankingModal();
            }
            if (event.target === confirmModal) {
                closeConfirmModal();
            }
        };
    </script>
</body>
</html>