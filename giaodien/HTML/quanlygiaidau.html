<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Qu·∫£n l√Ω gi·∫£i ƒë·∫•u</title>
  <link rel="stylesheet" href="/giaodien/CSS/quanlygiaidau.css" />
</head>
<body>
  <div class="sidebar">
    <h2>Qu·∫£n Tr·ªã</h2>
    <a href="quanlygiaidau.html">üì¶ Qu·∫£n l√Ω Gi·∫£i ƒê·∫•u</a>
    <a href="./quanlydoituyenvathanhvien.html">üßæ Qu·∫£n l√Ω ƒê·ªôi Tuy·ªÉn v√† Th√†nh Vi√™n</a>
    <a href="/giaodien/HTML/quanli_trandau.html">üë• Qu·∫£n l√Ω Tr·∫≠n ƒê·∫•u</a>
    <a href="#">üìä Qu·∫£n L√Ω B·∫£ng X·∫øp H·∫°ng</a>
    <a href="index.html">Quay L·∫°i</a>
  </div>

  <div class="content">
    <h2>Danh s√°ch Gi·∫£i ƒê·∫•u</h2>
    <table id="giaiTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>T√™n Gi·∫£i</th>
          <th>Ng√†y B·∫Øt ƒê·∫ßu</th>
          <th>Ng√†y K·∫øt Th√∫c</th>
          <th>M√¥ T·∫£</th>
          <th>H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody>
        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ch√®n ·ªü ƒë√¢y b·∫±ng JavaScript -->
      </tbody>
    </table>
  </div>

  <script>
    async function loadGiaiDau() {
      try {
        const res = await fetch("http://127.0.0.1:5000/GiaiDau/GetAll");
        const data = await res.json();
        const tbody = document.querySelector("#giaiTable tbody");
        tbody.innerHTML = "";

        data.forEach(giai => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${giai.IdGiai}</td>
            <td>${giai.TenGiai}</td>
            <td>${giai.NgayBatDau || ""}</td>
            <td>${giai.NgayKetThuc || ""}</td>
            <td>${giai.MoTa || ""}</td>
            <td><button onclick="xoaGiaiDau(${giai.IdGiai})" >Xo√°</button></td>
          `;
          tbody.appendChild(row);
        });
      } catch (error) {
        console.error("L·ªói khi t·∫£i gi·∫£i ƒë·∫•u:", error);
      }
    }

    async function xoaGiaiDau(id) {
      if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën xo√° gi·∫£i ƒë·∫•u n√†y kh√¥ng?")) {
        try {
          const res = await fetch(`http://127.0.0.1:5000/GiaiDau/Delete/${id}`, {
            method: "DELETE"
          });
          const result = await res.json();
          if (res.ok) {
            alert(result.message || "Xo√° th√†nh c√¥ng!");
            loadGiaiDau(); // T·∫£i l·∫°i danh s√°ch sau khi xo√°
          } else {
            alert(result.error || "C√≥ l·ªói x·∫£y ra khi xo√°!");
          }
        } catch (error) {
          console.error("L·ªói khi g·ªçi API xo√°:", error);
        }
      }
    }

    window.onload = loadGiaiDau;
  </script>
</body>
</html>
